{% extends 'MSMEOrderingWebApp/business_owner_base.html' %}

{% block title %}Orders Dashboard{% endblock %}

{% block content %}
<style>
    .stats-cards {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-bottom: 20px;
    }

    .card {
        flex: 1;
        min-width: 150px;
        background: white;
        border: 1px solid #ccc;
        text-align: center;
        padding: 10px;
        box-shadow: 1px 1px 4px rgba(0,0,0,0.1);
    }

    .card h4 {
        margin: 10px 0 5px;
    }

    .card span {
        font-size: 24px;
        font-weight: bold;
        display: block;
    }

    .tabs {
        display: flex;
        border-bottom: 2px solid #aaa;
        margin-bottom: 10px;
        flex-wrap: wrap;
    }

    .tab-button {
        padding: 10px 15px;
        background: #ddd;
        border: none;
        cursor: pointer;
        margin-right: 5px;
        font-weight: bold;
    }

    .tab-button.active {
        background: white;
        border-bottom: 2px solid white;
    }

    .tab-content {
        display: none;
        background: white;
        padding: 10px;
        border: 1px solid #ccc;
    }

    .tab-content.active {
        display: block;
    }

    .search-bar {
        margin-bottom: 10px;
    }

    .search-bar input {
        padding: 5px;
        width: 200px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    table thead {
        background-color: black;
        color: white;
    }

    table th, table td {
        padding: 8px;
        border: 1px solid #ccc;
        text-align: center;
    }

    table td {
        background-color: #fefefe;
    }

    .text-end {
        text-align: right;
        margin-bottom: 10px;
    }

    .btn-dark {
        background-color: black;
        color: white;
        padding: 8px 15px;
        border: none;
        cursor: pointer;
        font-weight: bold;
    }

    .table-responsive {
        overflow-x: auto;
    }

    .table-bordered {
        border: 1px solid #ccc;
    }

    .table-striped tr:nth-child(even) {
        background-color: #f9f9f9;
    }

    .table-dark th {
        background-color: black;
        color: white;
    }
</style>

<div class="container-fluid">
    <div class="stats-cards">
        <div class="card">
            <h4>Inventory Products</h4>
            <span>{{ total_inventory|default:"0" }}</span>
        </div>
        <div class="card">
            <h4>Pending Orders</h4>
            <span>{{ total_pending|default:"0" }}</span>
        </div>
        <div class="card">
            <h4>Preparing Orders</h4>
            <span>{{ total_preparing|default:"0" }}</span>
        </div>
        <div class="card">
            <h4>Declined Orders</h4>
            <span>{{ total_declined|default:"0" }}</span>
        </div>
        <div class="card">
            <h4>Completed Orders</h4>
            <span>{{ total_completed|default:"0" }}</span>
        </div>
        <div class="card">
            <h4>Total Sales</h4>
            <span>â‚±{{ total_sales|default:"0.00" }}</span>
        </div>
    </div>

    <div class="text-end">
        <form method="post">
            {% csrf_token %}
            <button type="submit" class="btn-dark">ðŸ“„ Generate Report</button>
        </form>
    </div>

    <div class="tabs">
        <button class="tab-button active" onclick="showTab('accepted')">ACCEPTED ORDERS</button>
        <button class="tab-button" onclick="showTab('declined')">DECLINED ORDERS</button>
        <button class="tab-button" onclick="showTab('completed')">COMPLETED ORDERS</button>
    </div>

    <!-- Accepted Orders -->
    <div id="accepted" class="tab-content active">
        <div class="search-bar">
            <input type="text" placeholder="Search">
        </div>
        <div class="table-responsive">
            <table class="table-bordered table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>Order ID</th>
                        <th>Customer Details</th>
                        <th>Date and Time</th>
                        <th>Ordered Items</th>
                        <th>Total</th>
                        <th>Mode of Payment</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in accepted_orders %}
                    <tr>
                        <td>{{ order.id }}</td>
                        <td>{{ order.customer_name }}</td>
                        <td>{{ order.date }}</td>
                        <td>{{ order.items }}</td>
                        <td>â‚±{{ order.total }}</td>
                        <td>{{ order.payment_method }}</td>
                        <td></td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="7">No accepted orders yet.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Declined Orders -->
    <div id="declined" class="tab-content">
        <div class="search-bar">
            <input type="text" placeholder="Search">
        </div>
        <div class="table-responsive">
            <table class="table-bordered table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>Order ID</th>
                        <th>Customer Details</th>
                        <th>Date and Time</th>
                        <th>Ordered Items</th>
                        <th>Total</th>
                        <th>Mode of Payment</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in declined_orders %}
                    <tr>
                        <td>{{ order.id }}</td>
                        <td>{{ order.customer_name }}</td>
                        <td>{{ order.date }}</td>
                        <td>{{ order.items }}</td>
                        <td>â‚±{{ order.total }}</td>
                        <td>{{ order.payment_method }}</td>
                        <td></td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="7">No declined orders.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Completed Orders -->
    <div id="completed" class="tab-content">
        <div class="search-bar">
            <input type="text" placeholder="Search">
        </div>
        <div class="table-responsive">
            <table class="table-bordered table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>Order ID</th>
                        <th>Customer Details</th>
                        <th>Date and Time</th>
                        <th>Ordered Items</th>
                        <th>Total</th>
                        <th>Mode of Payment</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in completed_orders %}
                    <tr>
                        <td>{{ order.id }}</td>
                        <td>{{ order.customer_name }}</td>
                        <td>{{ order.date }}</td>
                        <td>{{ order.items }}</td>
                        <td>â‚±{{ order.total }}</td>
                        <td>{{ order.payment_method }}</td>
                        <td></td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="7">No completed orders.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    function showTab(tabId) {
        const tabs = document.querySelectorAll('.tab-content');
        const buttons = document.querySelectorAll('.tab-button');

        tabs.forEach(tab => tab.classList.remove('active'));
        buttons.forEach(btn => btn.classList.remove('active'));

        document.getElementById(tabId).classList.add('active');
        event.target.classList.add('active');
    }
</script>
{% endblock %}
